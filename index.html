<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Schema LLM Instructions</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }
        h1 {
            font-size: 28px;
            color: #2c3e50;
        }
        h2 {
            font-size: 22px;
            color: #34495e;
            margin-top: 20px;
        }
        h3 {
            font-size: 18px;
            color: #7f8c8d;
            margin-left: 20px;
        }
        p {
            font-size: 16px;
            color: #555;
            margin-bottom: 10px;
        }
        .property {
            margin-left: 40px;
            font-size: 14px;
        }
        .error-container {
            background-color: #fff3f3;
            border: 1px solid #ffcdd2;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .error-title {
            color: #d32f2f;
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
        }
        .error-title::before {
            content: "⚠️";
            margin-right: 10px;
        }
        .error-message {
            color: #b71c1c;
            font-size: 16px;
            margin-bottom: 10px;
        }
        .error-details {
            background-color: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 10px;
            font-family: monospace;
            font-size: 14px;
            color: #495057;
            margin-top: 10px;
            white-space: pre-wrap;
            overflow-x: auto;
        }
        .error-suggestion {
            color: #1976d2;
            font-size: 14px;
            margin-top: 10px;
            padding: 10px;
            background-color: #e3f2fd;
            border-radius: 4px;
        }
        .loading {
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            color: #666;
        }
        .loading::after {
            content: "⏳";
            margin-left: 10px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>GenAiInstructions</h1>
    <div class="description-block" style="max-width:800px;margin:2rem auto 2.5rem auto;padding:1.5rem 2rem;background:var(--card-background,#fff);border-radius:0.5rem;box-shadow:0 2px 8px 0 rgb(0 0 0 / 0.06);border:1px solid #e2e8f0;">
        <h2 style="color:#2563eb;font-size:1.5rem;margin-bottom:0.5rem;">Description</h2>
        <p style="color:#334155;font-size:1.05rem;line-height:1.7;margin-bottom:0.5rem;">
            GenAiInstructions provides a user-friendly interface for generating and validating LLM (Large Language Model) instructions based on a structured schema. Easily configure creativity, output, safety, and performance parameters for your AI models.
        </p>
        <div style="color:#64748b;font-size:0.98rem;margin-top:0.5rem;">
            Created by <b>Luc Bizeul</b>, under <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener" style="color:#2563eb;">CC BY-NC 4.0</a> license.
        </div>
    </div>
    <p><strong>Description :</strong> Schema LLM Instructions is a Schema.org extension that allows for providing instructions and technical parameters to large language models (LLMs). It aims to improve communication between humans and LLMs by enabling users to specify precise tasks, constraints, and preferences for text generation.</p>

    <h2>Categories and Properties</h2>
    <div id="content">
        <div class="loading">Loading data from: <span id="jsonUrl"></span></div>
    </div>

    <script>
        // URL du fichier JSON sur GitHub raw
        const jsonURL = "https://raw.githubusercontent.com/LucBizeul/Schemas-LLMInstructions/main/GenAiInstructions.json";
        
        // Afficher l'URL dans le message de chargement
        document.getElementById('jsonUrl').textContent = jsonURL;

        // Fonction pour afficher les erreurs de manière détaillée
        function displayError(error, details = null) {
            const contentDiv = document.getElementById('content');
            const errorContainer = document.createElement('div');
            errorContainer.className = 'error-container';

            const errorTitle = document.createElement('div');
            errorTitle.className = 'error-title';
            errorTitle.textContent = 'Error Loading Data';

            const errorMessage = document.createElement('div');
            errorMessage.className = 'error-message';
            errorMessage.textContent = error.message;

            const errorUrl = document.createElement('div');
            errorUrl.className = 'error-details';
            errorUrl.innerHTML = `<strong>Attempted to load from:</strong><br>${jsonURL}`;

            errorContainer.appendChild(errorTitle);
            errorContainer.appendChild(errorMessage);
            errorContainer.appendChild(errorUrl);

            if (details) {
                const errorDetails = document.createElement('div');
                errorDetails.className = 'error-details';
                errorDetails.textContent = details;
                errorContainer.appendChild(errorDetails);
            }

            // Ajouter des suggestions de résolution
            const errorSuggestion = document.createElement('div');
            errorSuggestion.className = 'error-suggestion';
            errorSuggestion.innerHTML = `
                <strong>Suggestions:</strong>
                <ul>
                    <li>Vérifiez que l'URL est correcte: ${jsonURL}</li>
                    <li>Vérifiez votre connexion internet</li>
                    <li>Assurez-vous que le fichier JSON est accessible</li>
                    <li>Vérifiez que le fichier JSON est valide</li>
                    <li>Réessayez de recharger la page</li>
                </ul>
            `;
            errorContainer.appendChild(errorSuggestion);

            contentDiv.innerHTML = '';
            contentDiv.appendChild(errorContainer);
        }

        // Fonction pour récupérer et afficher les classes avec leurs propriétés
        async function fetchAndDisplayClassesWithProperties() {
            const contentDiv = document.getElementById('content');

            try {
                const response = await fetch(jsonURL);
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                let jsonData;
                try {
                    jsonData = await response.json();
                } catch (parseError) {
                    throw new Error(`Invalid JSON format: ${parseError.message}`);
                }

                // Vérifier la structure du JSON
                if (!jsonData["@graph"]) {
                    throw new Error("Invalid JSON structure: missing @graph property");
                }

                // Extraire les classes et propriétés
                const classes = jsonData["@graph"].filter(item => item["@type"] === "rdfs:Class");
                const properties = jsonData["@graph"].filter(item => item["@type"] === "rdf:Property");

                if (classes.length === 0) {
                    throw new Error("No classes found in the JSON data");
                }

                // Regrouper les propriétés par classe
                const propertiesByClass = {};
                properties.forEach(prop => {
                    const domain = prop["rdfs:domain"]?.["@id"];
                    if (domain) {
                        if (!propertiesByClass[domain]) {
                            propertiesByClass[domain] = [];
                        }
                        propertiesByClass[domain].push(prop);
                    }
                });

                // Afficher chaque classe avec ses propriétés
                contentDiv.innerHTML = '';
                classes.forEach(cls => {
                    const classTitle = document.createElement('h2');
                    classTitle.textContent = cls["rdfs:label"] || cls["@id"];
                    contentDiv.appendChild(classTitle);

                    const description = document.createElement('p');
                    description.textContent = cls["rdfs:comment"] || "No description available.";
                    contentDiv.appendChild(description);

                    // Ajouter les propriétés associées à la classe
                    const classProperties = propertiesByClass[cls["@id"]] || [];
                    if (classProperties.length > 0) {
                        classProperties.forEach(prop => {
                            const propTitle = document.createElement('h3');
                            propTitle.textContent = prop["rdfs:label"] || prop["@id"];
                            contentDiv.appendChild(propTitle);

                            const propDescription = document.createElement('p');
                            propDescription.textContent = prop["rdfs:comment"] || "No description available.";
                            contentDiv.appendChild(propDescription);

                            const domainRangeInfo = document.createElement('p');
                            domainRangeInfo.className = 'property';
                            domainRangeInfo.textContent = `Domain: ${cls["rdfs:label"] || cls["@id"]}, Range: ${prop["rdfs:range"]?.["@id"] || "N/A"}`;
                            contentDiv.appendChild(domainRangeInfo);
                        });
                    } else {
                        const noProperties = document.createElement('p');
                        noProperties.className = 'property';
                        noProperties.textContent = "No properties associated with this class.";
                        contentDiv.appendChild(noProperties);
                    }
                });
            } catch (error) {
                displayError(error, error.stack);
            }
        }

        // Charger et afficher les classes avec leurs propriétés
        fetchAndDisplayClassesWithProperties();
    </script>
    <footer style="margin-top:2rem; text-align:center; color:#64748b; font-size:0.95rem;">
        <hr style="margin-bottom:1rem;">
        <div>
            &copy; 2024–2025 Luc Bizeul &mdash; Licensed under <a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener" style="color:#2563eb;">CC BY-NC 4.0</a>
        </div>
    </footer>
</body>
</html>
